<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tuni•Learn</title>

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial}
body{background:#111;color:#1e90ff;min-height:100vh}
button,input{border:none;border-radius:10px;padding:10px}
#auth,#home,#subjectPage,#examPage{display:none}
#auth{display:flex;justify-content:center;align-items:center;height:100vh}
.box{background:#1a1a1a;width:90%;max-width:360px;padding:20px;border-radius:20px;text-align:center}
.box h1{color:#fff;margin-bottom:10px}
.box p{color:#87cefa;margin-bottom:10px}
.box input{width:100%;margin:5px 0}
.box button{width:48%;background:#e53935;color:white;font-weight:bold;cursor:pointer}
.row{display:flex;justify-content:space-between;margin-top:8px}
#forgot{width:100%;background:#2196f3;margin-top:8px}
#status{margin-top:10px;color:#ff5252}

#home{padding:20px;text-align:center}
.banner{background:#87cefa;color:black;padding:12px;border-radius:14px;font-weight:bold}
.level{background:#222;border:2px solid #1e90ff;border-radius:14px;padding:14px;margin-top:12px;color:white;cursor:pointer;text-align:right}

#subjectPage,#examPage{padding:20px;text-align:center}
.subject{border:2px solid red;border-radius:12px;padding:10px;margin:6px;color:white;cursor:pointer}
.exam{border:2px solid green;border-radius:12px;padding:10px;margin:6px;color:white}
.back{margin-top:20px;background:#444;color:white}
</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-analytics.js";
import {
getAuth,
createUserWithEmailAndPassword,
signInWithEmailAndPassword,
sendPasswordResetEmail,
onAuthStateChanged,
signOut
} from "https://www.gstatic.com/firebasejs/10.10.0/firebase-auth.js";

/* Firebase CONFIG (نفس اللي عطيتني حرف حرف) */
const firebaseConfig = {
apiKey: "AIzaSyCXzhUgYy1MMvnftDi1d5XFeRJTFa35eQU",
authDomain: "tunilearn-e4b8e.firebaseapp.com",
projectId: "tunilearn-e4b8e",
storageBucket: "tunilearn-e4b8e.firebasestorage.app",
messagingSenderId: "730477107505",
appId: "1:730477107505:web:eee97b8ef099326b8cf810",
measurementId: "G-H17BY13PDN"
};

const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const auth = getAuth(app);

/* إجبار إعادة تسجيل الدخول كل مرة */
signOut(auth);

/* DOM */
const authDiv=document.getElementById("auth");
const home=document.getElementById("home");
const subjectPage=document.getElementById("subjectPage");
const examPage=document.getElementById("examPage");
const status=document.getElementById("status");

/* AUTH STATE */
onAuthStateChanged(auth,user=>{
if(user){
authDiv.style.display="none";
home.style.display="block";
renderLevels();
}else{
authDiv.style.display="flex";
home.style.display="none";
}
});

/* AUTH FUNCTIONS */
window.signup=()=>{
if(!email.value||!password.value){status.innerText="املأ الحقول";return;}
createUserWithEmailAndPassword(auth,email.value,password.value)
.then(()=>status.innerText="تم إنشاء الحساب")
.catch(()=>status.innerText="فشل التسجيل");
};

window.login=()=>{
signInWithEmailAndPassword(auth,email.value,password.value)
.catch(()=>status.innerText="بيانات خاطئة");
};

window.forgotPassword=()=>{
if(!email.value){status.innerText="أدخل الإيميل";return;}
sendPasswordResetEmail(auth,email.value)
.then(()=>status.innerText="تم إرسال رسالة للإيميل")
.catch(()=>status.innerText="إيميل غير صحيح");
};

/* DATA */
const data={
"7 أساسي":["عربية","فرنسية","انقليزية","رياضيات","علوم","فيزياء","تكنولوجيا","اعلامية","تاريخ","جغرافيا","اسلامية","مدنية"],
"8 أساسي":["عربية","فرنسية","انقليزية","رياضيات","علوم","فيزياء","تكنولوجيا","اعلامية","تاريخ","جغرافيا","اسلامية","مدنية"],
"9 أساسي":["عربية","فرنسية","انقليزية","رياضيات","علوم","فيزياء","تكنولوجيا","اعلامية","تاريخ","جغرافيا","اسلامية","مدنية"],
"1 ثانوي":["عربية","فرنسية","انقليزية","رياضيات","علوم الحياة والارض","فيزياء","كيمياء","تكنولوجيا","اعلامية","تاريخ","جغرافيا","اسلامية","مدنية"],
"2 ثانوي علوم":["عربية","فرنسية","انقليزية","رياضيات","علوم الحياة والارض","فيزياء","كيمياء","اعلامية","فلسفة"],
"2 ثانوي آداب":["عربية","فرنسية","انقليزية","فلسفة","تاريخ","جغرافيا","اسلامية","مدنية"],
"2 ثانوي اقتصاد":["عربية","فرنسية","انقليزية","اقتصاد","تصرف","رياضيات","تاريخ","جغرافيا"],
"2 ثانوي تقنية":["عربية","فرنسية","انقليزية","رياضيات","فيزياء","تكنولوجيا","اعلامية"],
"3 ثانوي علوم":["عربية","فرنسية","انقليزية","رياضيات","علوم الحياة والارض","فيزياء","كيمياء","فلسفة"],
"3 ثانوي آداب":["عربية","فرنسية","انقليزية","فلسفة","تاريخ","جغرافيا","اسلامية"],
"3 ثانوي اقتصاد":["عربية","فرنسية","انقليزية","اقتصاد","تصرف","رياضيات","فلسفة"],
"3 ثانوي تقنية":["عربية","فرنسية","انقليزية","رياضيات","فيزياء","تكنولوجيا","اعلامية"],
"4 ثانوي علوم":["عربية","فرنسية","انقليزية","رياضيات","علوم الحياة والارض","فيزياء","كيمياء","فلسفة"],
"4 ثانوي آداب":["عربية","فرنسية","انقليزية","فلسفة","تاريخ","جغرافيا","اسلامية"],
"4 ثانوي اقتصاد":["عربية","فرنسية","انقليزية","اقتصاد","تصرف","رياضيات","فلسفة"],
"4 ثانوي تقنية":["عربية","فرنسية","انقليزية","رياضيات","فيزياء","تكنولوجيا","اعلامية"]
};

/* UI */
window.renderLevels=()=>{
levels.innerHTML="";
Object.keys(data).forEach(l=>{
let d=document.createElement("div");
d.className="level";
d.innerText=l;
d.onclick=()=>openSubjects(l);
levels.appendChild(d);
});
};

window.openSubjects=(lvl)=>{
home.style.display="none";
subjectPage.style.display="block";
title.innerText=lvl;
subjects.innerHTML="";
data[lvl].forEach(s=>{
let d=document.createElement("div");
d.className="subject";
d.innerText=s;
d.onclick=()=>openExams(s);
subjects.appendChild(d);
});
};

window.openExams=(s)=>{
subjectPage.style.display="none";
examPage.style.display="block";
examTitle.innerText=s;
};

window.backHome=()=>{subjectPage.style.display="none";home.style.display="block";}
window.backSubjects=()=>{examPage.style.display="none";subjectPage.style.display="block";}
</script>
</head>

<body>

<div id="auth">
<div class="box">
<h1>Tuni•Learn</h1>
<p>سجل وابدأ</p>
<input id="email" placeholder="Email">
<input id="password" type="password" placeholder="Password">
<div class="row">
<button onclick="signup()">Sign up</button>
<button onclick="login()">Log in</button>
</div>
<button id="forgot" onclick="forgotPassword()">نسيت كلمة المرور</button>
<div id="status"></div>
</div>
</div>

<div id="home">
<div class="banner">كل المستويات و الشعب</div>
<div id="levels"></div>
</div>

<div id="subjectPage">
<h2 id="title"></h2>
<div id="subjects"></div>
<button class="back" onclick="backHome()">رجوع</button>
</div>

<div id="examPage">
<h2 id="examTitle"></h2>
<div class="exam">فروض مراقبة</div>
<div class="exam">فروض تأليفية</div>
<div class="exam">امتحانات</div>
<button class="back" onclick="backSubjects()">رجوع</button>
</div>

</body>
</html>
